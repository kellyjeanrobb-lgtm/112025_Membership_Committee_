<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Membership Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Tailwind via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React + ReactDOM (production) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Recharts UMD -->
    <script src="https://unpkg.com/recharts/umd/Recharts.min.js"></script>

    <!-- Babel so we can write JSX directly in this file -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>

  <body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
      const {
        BarChart,
        Bar,
        LineChart,
        Line,
        ComposedChart,
        Area,
        PieChart,
        Pie,
        XAxis,
        YAxis,
        CartesianGrid,
        Tooltip,
        Legend,
        ResponsiveContainer,
        Cell,
        ReferenceLine,
        LabelList,
      } = Recharts;

      const MembershipDashboard = () => {
        // November Data
        const fluxData = [
          { name: "Headcount", New: 61, Resigned: 53, Net: 8 },
          { name: "Accounts", New: 35, Resigned: 38, Net: -3 },
        ];

        // Updated Pipeline Data for November
        const pipelineData = [
          {
            name: "Applicants",
            value: 113,
            fill: "#94a3b8",
            desc: "Has completed an application AND has paid application fee $100",
          },
          {
            name: "Deposits/WL",
            fullName: "Waitlist",
            value: 18,
            fill: "#60a5fa",
            desc: "Has submitted deposit or is legacy and/or spouse internal waitlist",
          },
          {
            name: "In Processing",
            value: 111,
            fill: "#3b82f6",
            desc: "Pulled off waitlist to begin pre-governance review, required 30-day posting, background checks, confirm letters of recommendation",
          },
          {
            name: "Cmte. Review",
            fullName: "Committee Review",
            value: 44,
            fill: "#2563eb",
            desc: "Application package is submitted and under Membership Committee and/or Board Review",
          },
          {
            name: "Invited",
            value: 90,
            fill: "#1d4ed8",
            desc: "Formally invited to join",
          },
        ];

        // November Financials
        const financials = [
          { label: "New Deposits", value: 52300, color: "text-emerald-600", bg: "bg-emerald-100" },
          { label: "Remaining Election", value: 134596, color: "text-blue-600", bg: "bg-blue-100" },
          { label: "Application Fees", value: 1600, color: "text-indigo-600", bg: "bg-indigo-100" },
          { label: "Reinstatements", value: 1477.54, color: "text-purple-600", bg: "bg-purple-100" },
        ];

        // YTD Metrics
        const ytdMetrics = [
          {
            label: "Applications Reviewed",
            value: 380,
            color: "text-blue-600",
            bg: "bg-blue-50",
          },
          {
            label: "New Members Onboarded",
            value: 327,
            color: "text-emerald-600",
            bg: "bg-emerald-50",
          },
          {
            label: "Total Resignations",
            value: 581,
            color: "text-orange-600",
            bg: "bg-orange-50",
          },
          {
            label: "Accounts in Pipeline",
            value: 376,
            color: "text-violet-600",
            bg: "bg-violet-50",
          },
          {
            label: "Exception Requests",
            value: 22,
            color: "text-purple-600",
            bg: "bg-purple-50",
          },
          {
            label: "Intermediates Elected",
            value: 57,
            color: "text-indigo-600",
            bg: "bg-indigo-50",
          },
          {
            label: "Jrs Transferred to Int.",
            value: 249,
            color: "text-cyan-600",
            bg: "bg-cyan-50",
          },
        ];

        const newAccountsBreakdown = [
          { label: "Family", value: 10 },
          { label: "Family of 2", value: 2 },
          { label: "Individual", value: 7 },
          { label: "Individual Under 30", value: 9 },
          { label: "Intermediate", value: 1 },
          { label: "Nonresident Under 30", value: 2 },
          { label: "Spouse", value: 4 },
        ];

        const resignedAccountsBreakdown = [
          { label: "Family", value: 1 },
          { label: "Family of 2", value: 5 },
          { label: "Family Pref. Tier 2", value: 1 },
          { label: "Individual", value: 11 },
          { label: "Individual Pref. Tier 3", value: 1 },
          { label: "Intermediate", value: 10 },
          { label: "Intermediate Ext. School", value: 1 },
          { label: "Nonresident", value: 2 },
          { label: "Nonresident 30-34", value: 1 },
          { label: "Nonresident Family", value: 2 },
          { label: "Spouse", value: 2 },
          { label: "Spouse Preferred", value: 1 },
        ];

        const censusAgeData = [
          { name: "< 18", value: 4359, fill: "#cbd5e1" },
          { name: "18-29", value: 2180, fill: "#94a3b8" },
          { name: "30-49", value: 7629, fill: "#64748b" },
          { name: "50-69", value: 5450, fill: "#475569" },
          { name: "70+", value: 2181, fill: "#334155" },
        ];

        const censusTypeData = [
          { name: "Family", value: 8720, fill: "#3b82f6" },
          { name: "Individual", value: 6540, fill: "#10b981" },
          { name: "Junior", value: 3270, fill: "#f59e0b" },
          { name: "Nonresident", value: 2180, fill: "#6366f1" },
          { name: "Other", value: 1089, fill: "#94a3b8" },
        ];

        const formatCurrency = (val) =>
          new Intl.NumberFormat("en-US", {
            style: "currency",
            currency: "USD",
            maximumFractionDigits: 0,
          }).format(val);

        const formatCurrencyPrecise = (val) =>
          new Intl.NumberFormat("en-US", {
            style: "currency",
            currency: "USD",
            minimumFractionDigits: 2,
          }).format(val);

        // Custom Tooltip for Pipeline
        const CustomPipelineTooltip = ({ active, payload }) => {
          if (active && payload && payload.length) {
            const data = payload[0].payload;
            return (
              <div className="bg-white p-3 border border-slate-200 shadow-xl rounded-lg max-w-xs z-50">
                <p className="font-bold text-slate-900">
                  {data.fullName || data.name}
                </p>
                <p className="text-xl font-bold text-blue-600 my-1">
                  {data.value}
                </p>
                <p className="text-xs text-slate-500 leading-snug">{data.desc}</p>
              </div>
            );
          }
          return null;
        };

        return (
          <div className="min-h-screen bg-slate-50 p-4 md:p-8 font-sans text-slate-900">
            {/* Header */}
            <header className="mb-8 border-b border-slate-200 pb-6">
              <div className="flex flex-col md:flex-row md:items-center justify-between">
                <div>
                  <h1 className="text-4xl font-extrabold text-slate-900 tracking-tight">
                    Membership Dashboard
                  </h1>
                  <p className="text-slate-500 mt-2 text-lg">
                    November 2025 Performance Overview
                  </p>
                </div>
                <div className="mt-6 md:mt-0 flex gap-4">
                  <div className="px-6 py-4 bg-white rounded-xl border border-slate-200 shadow-sm text-center">
                    <span className="text-xs font-bold text-slate-400 uppercase tracking-widest block mb-1">
                      Total Members
                    </span>
                    <div className="text-3xl font-black text-slate-800">
                      21,799
                    </div>
                  </div>
                  <div className="px-6 py-4 bg-white rounded-xl border border-slate-200 shadow-sm text-center">
                    <span className="text-xs font-bold text-slate-400 uppercase tracking-widest block mb-1">
                      Total Accounts
                    </span>
                    <div className="text-3xl font-black text-slate-800">
                      11,550
                    </div>
                  </div>
                </div>
              </div>
            </header>

            {/* YTD Snapshot Section */}
            <div className="mb-10">
              <h2 className="text-xl font-bold text-slate-800 mb-6 flex items-center">
                <span className="bg-slate-800 w-2 h-6 mr-3 rounded-sm"></span>
                Membership Snapshot (YTD 2025)
              </h2>
              <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-4">
                {ytdMetrics.map((metric, idx) => (
                  <div
                    key={idx}
                    className="bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col justify-between h-full transition-shadow hover:shadow-md"
                  >
                    <div className="flex justify-between items-start mb-3">
                      <div
                        className={`p-2.5 rounded-lg ${metric.bg} text-xs font-bold`}
                      >
                        {/* Simple emoji as icon */}
                        <span className={metric.color}>üìä</span>
                      </div>
                    </div>
                    <div>
                      <div className="text-2xl font-bold text-slate-900">
                        {metric.value}
                      </div>
                      <div className="text-xs font-semibold text-slate-500 mt-1 leading-tight">
                        {metric.label}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>

            {/* Top Level Monthly KPIs */}
            <h2 className="text-xl font-bold text-slate-800 mb-6 flex items-center">
              <span className="bg-blue-600 w-2 h-6 mr-3 rounded-sm"></span>
              November Monthly Performance
            </h2>

            {/* Primary KPIs */}
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
              {/* Monthly Dues */}
              <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-sm font-semibold text-slate-500">
                    Total Monthly Dues
                  </h3>
                  <div className="p-2 bg-blue-50 rounded-lg text-lg">üíµ</div>
                </div>
                <div className="text-2xl font-bold text-slate-900">
                  {formatCurrency(2824009)}
                </div>
                <p className="text-xs text-slate-400 mt-1">
                  Recurring monthly revenue
                </p>
              </div>

              {/* Net Monthly Dues Change */}
              <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-sm font-semibold text-slate-500">
                    Net Dues Change
                  </h3>
                  <div className="p-2 bg-emerald-50 rounded-lg text-lg">
                    üìà
                  </div>
                </div>
                <div className="text-2xl font-bold text-emerald-600">
                  +{formatCurrencyPrecise(1477.54)}
                </div>
                <p className="text-xs text-emerald-600 mt-1 flex items-center font-medium">
                  <span className="mr-1">‚¨ÜÔ∏è</span>
                  New Adds &gt; Resignations
                </p>
              </div>

              {/* New Accounts Value */}
              <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-sm font-semibold text-slate-500">
                    New Accounts Value
                  </h3>
                  <div className="p-2 bg-emerald-50 rounded-lg text-lg">
                    üü¢
                  </div>
                </div>
                <div className="text-2xl font-bold text-emerald-600">
                  +{formatCurrency(8582)}
                </div>
                <p className="text-xs text-slate-400 mt-1">
                  From 35 new accounts
                </p>
              </div>

              {/* Resigned Value */}
              <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-sm font-semibold text-slate-500">
                    Resigned Value
                  </h3>
                </div>
                <div className="text-2xl font-bold text-orange-600">
                  -{formatCurrency(7104)}
                </div>
                <p className="text-xs text-slate-400 mt-1">
                  From 38 resigned accounts
                </p>
              </div>
            </div>

            {/* Breakdown Details Row */}
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
              {/* New Accounts Breakdown */}
              <div className="bg-white p-5 rounded-xl border border-slate-200 shadow-sm h-full">
                <div className="flex items-center justify-between mb-4 pb-2 border-b border-slate-100">
                  <h3 className="font-bold text-slate-900">
                    New Accounts by Type
                  </h3>
                  <span className="px-2 py-1 bg-emerald-100 text-emerald-800 text-xs font-bold rounded-full">
                    35 Total
                  </span>
                </div>
                <div className="space-y-2">
                  {newAccountsBreakdown.map((item, idx) => (
                    <div
                      key={idx}
                      className="flex justify-between items-center text-sm"
                    >
                      <span className="text-slate-600">{item.label}</span>
                      <span className="font-bold text-slate-900">
                        {item.value}
                      </span>
                    </div>
                  ))}
                </div>
              </div>

              {/* Resigned Accounts Breakdown */}
              <div className="bg-white p-5 rounded-xl border border-slate-200 shadow-sm h-full">
                <div className="flex items-center justify-between mb-4 pb-2 border-b border-slate-100">
                  <h3 className="font-bold text-slate-900">
                    Resignations by Type
                  </h3>
                  <span className="px-2 py-1 bg-orange-100 text-orange-800 text-xs font-bold rounded-full">
                    38 Total
                  </span>
                </div>
                <div className="space-y-2">
                  {resignedAccountsBreakdown.map((item, idx) => (
                    <div
                      key={idx}
                      className="flex justify-between items-center text-sm"
                    >
                      <span className="text-slate-600">{item.label}</span>
                      <span className="font-bold text-slate-900">
                        {item.value}
                      </span>
                    </div>
                  ))}
                </div>
              </div>

              {/* Jr to Int Transfer Metric */}
              <div className="flex flex-col gap-4">
                <div className="bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex-1 flex flex-col justify-center items-center text-center">
                  <div className="p-4 bg-cyan-50 rounded-full mb-3 text-2xl">
                    üîÅ
                  </div>
                  <div className="text-4xl font-black text-slate-900">14</div>
                  <div className="text-sm font-bold text-slate-500 uppercase tracking-wide mt-2">
                    Junior to Intermediate
                  </div>
                  <div className="text-xs text-slate-400 mt-1">
                    Transfers in November
                  </div>
                </div>
              </div>
            </div>

            {/* Charts Section */}
            <div className="grid grid-cols-1 xl:grid-cols-2 gap-8 mb-10">
              {/* Membership Flux Chart */}
              <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex flex-col">
                <div className="mb-4">
                  <h3 className="text-lg font-bold text-slate-900">
                    Membership Flux (Nov)
                  </h3>
                  <p className="text-sm text-slate-500">
                    Comparison of Inflow vs. Outflow
                  </p>
                </div>
                <div className="h-64 w-full">
                  <ResponsiveContainer width="100%" height="100%">
                    <BarChart
                      data={fluxData}
                      margin={{ top: 20, right: 30, left: 0, bottom: 5 }}
                    >
                      <CartesianGrid
                        strokeDasharray="3 3"
                        vertical={false}
                        stroke="#e2e8f0"
                      />
                      <XAxis
                        dataKey="name"
                        axisLine={false}
                        tickLine={false}
                        tick={{ fill: "#64748b", fontSize: 12 }}
                        dy={10}
                      />
                      <YAxis
                        axisLine={false}
                        tickLine={false}
                        tick={{ fill: "#64748b", fontSize: 12 }}
                      />
                      <Tooltip
                        cursor={{ fill: "#f1f5f9" }}
                        contentStyle={{
                          borderRadius: "8px",
                          border: "none",
                          boxShadow:
                            "0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)",
                        }}
                      />
                      <Legend
                        iconType="circle"
                        wrapperStyle={{ paddingTop: "20px" }}
                      />
                      <ReferenceLine y={0} stroke="#94a3b8" />
                      <Bar
                        dataKey="New"
                        fill="#10b981"
                        name="New (Inflow)"
                        radius={[4, 4, 0, 0]}
                        barSize={48}
                      />
                      <Bar
                        dataKey="Resigned"
                        fill="#ef4444"
                        name="Resigned (Outflow)"
                        radius={[4, 4, 0, 0]}
                        barSize={48}
                      />
                    </BarChart>
                  </ResponsiveContainer>
                </div>
              </div>

              {/* Membership Pipeline Funnel */}
              <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex flex-col">
                <div className="mb-6 flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                  <div>
                    <h3 className="text-lg font-bold text-slate-900">
                      Membership Pipeline
                    </h3>
                    <p className="text-sm text-slate-500">
                      Current Candidate Status
                    </p>
                  </div>
                  <div className="flex items-center px-4 py-2 bg-blue-50 rounded-lg border border-blue-100 shadow-sm">
                    <div className="text-lg mr-3">üì•</div>
                    <div>
                      <span className="block text-[10px] font-bold text-blue-500 uppercase tracking-wider">
                        Total Accounts
                      </span>
                      <span className="text-lg font-bold text-blue-900 leading-none">
                        376
                      </span>
                    </div>
                  </div>
                </div>

                <div className="flex-grow flex flex-col md:flex-row gap-6">
                  <div className="h-[300px] w-full md:w-1/2">
                    <ResponsiveContainer width="100%" height="100%">
                      <BarChart
                        layout="vertical"
                        data={pipelineData}
                        margin={{ top: 0, right: 30, left: 40, bottom: 0 }}
                      >
                        <CartesianGrid
                          strokeDasharray="3 3"
                          horizontal={false}
                          stroke="#e2e8f0"
                        />
                        <XAxis type="number" hide />
                        <YAxis
                          dataKey="name"
                          type="category"
                          width={90}
                          tick={{
                            fill: "#475569",
                            fontSize: 11,
                            fontWeight: 600,
                          }}
                          axisLine={false}
                          tickLine={false}
                        />
                        <Tooltip content={<CustomPipelineTooltip />} />
                        <Bar dataKey="value" radius={[0, 4, 4, 0]}>
                          {pipelineData.map((item, index) => (
                            <Cell
                              key={\`cell-\${index}\`}
                              fill={item.fill}
                            />
                          ))}
                          <LabelList
                            dataKey="value"
                            position="right"
                            offset={8}
                            className="text-xs fill-slate-600"
                          />
                        </Bar>
                      </BarChart>
                    </ResponsiveContainer>
                  </div>

                  {/* Simple legend / explanation list */}
                  <div className="w-full md:w-1/2 flex flex-col gap-3 text-sm">
                    {pipelineData.map((stage, idx) => (
                      <div
                        key={idx}
                        className="flex items-start gap-3 p-3 rounded-lg bg-slate-50 border border-slate-100"
                      >
                        <div
                          className="w-2 h-8 rounded-full mt-0.5"
                          style={{ backgroundColor: stage.fill }}
                        />
                        <div>
                          <div className="flex justify-between items-baseline gap-3">
                            <p className="font-semibold text-slate-800">
                              {stage.fullName || stage.name}
                            </p>
                            <p className="text-xs font-mono text-slate-500">
                              {stage.value} accounts
                            </p>
                          </div>
                          <p className="text-xs text-slate-500 mt-1">
                            {stage.desc}
                          </p>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>

            {/* Census Section */}
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">
              <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                <h3 className="text-lg font-bold text-slate-900 mb-2">
                  Census by Age Band
                </h3>
                <p className="text-sm text-slate-500 mb-4">
                  Illustrative age distribution across the membership.
                </p>
                <div className="h-64">
                  <ResponsiveContainer width="100%" height="100%">
                    <PieChart>
                      <Pie
                        data={censusAgeData}
                        dataKey="value"
                        nameKey="name"
                        outerRadius={90}
                        innerRadius={40}
                        paddingAngle={2}
                      >
                        {censusAgeData.map((entry, index) => (
                          <Cell
                            key={\`age-cell-\${index}\`}
                            fill={entry.fill}
                          />
                        ))}
                      </Pie>
                      <Tooltip
                        formatter={(value) =>
                          new Intl.NumberFormat("en-US").format(value)
                        }
                      />
                      <Legend />
                    </PieChart>
                  </ResponsiveContainer>
                </div>
              </div>

              <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                <h3 className="text-lg font-bold text-slate-900 mb-2">
                  Census by Membership Type
                </h3>
                <p className="text-sm text-slate-500 mb-4">
                  Illustrative breakdown of account structures.
                </p>
                <div className="h-64">
                  <ResponsiveContainer width="100%" height="100%">
                    <PieChart>
                      <Pie
                        data={censusTypeData}
                        dataKey="value"
                        nameKey="name"
                        outerRadius={90}
                        innerRadius={40}
                        paddingAngle={2}
                      >
                        {censusTypeData.map((entry, index) => (
                          <Cell
                            key={\`type-cell-\${index}\`}
                            fill={entry.fill}
                          />
                        ))}
                      </Pie>
                      <Tooltip
                        formatter={(value) =>
                          new Intl.NumberFormat("en-US").format(value)
                        }
                      />
                      <Legend />
                    </PieChart>
                  </ResponsiveContainer>
                </div>
              </div>
            </div>

            {/* Footer */}
            <footer className="mt-8 pt-6 border-t border-slate-200 text-xs text-slate-400">
              Membership Dashboard ¬∑ November 2025 ¬∑ Internal use only
            </footer>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<MembershipDashboard />);
    </script>
  </body>
</html>